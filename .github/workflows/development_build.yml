---
name: Development Build

on:
  push:
    branches:
      - release/*

permissions:
  contents: write
  pull-requests: write

jobs:
  get-release-tag:
    name: Get Release Tag
    uses: worgarside/github-config-files/.github/workflows/__get_release_tag.yml@main
    with:
      branch-name: ${{ github.ref }}
    secrets:
      gh-token: ${{ secrets.WORGARSIDE_DEV_TOKEN }}

  run-development-build:
    name: Run Development Build
    needs:
      - get-release-tag
    uses: worgarside/github-config-files/.github/workflows/__build_and_publish.yml@main
    with:
      build-branch: ${{ github.ref }}
      build-type: python
      commit-build-directory: false
      environment: development
      publish-to-pypi: true
      python-version: '3.11'
      release-tag: ${{ needs.get-release-tag.outputs.release-tag }}
    secrets:
      gh-token: ${{ secrets.WORGARSIDE_DEV_TOKEN }}
      PYPI_API_TOKEN: ${{ secrets.PYPI_API_TOKEN }}
